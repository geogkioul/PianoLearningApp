# 🎹 PlayWise: Εφαρμογή εκκμάθησης πιάνου με Αυτόματη Μεταγραφή και Εκτίμηση Δυσκολίας κομματιών

Καλώς ήρθατε στο αποθετήριο του PlayWise. Το παρόν λογισμικό αποτελεί ένα ολοκληρωμένο σύστημα (Full-Stack Web Application) που σχεδιάστηκε για να γεφυρώσει το χάσμα μεταξύ της ακουστικής μουσικής εκτέλεσης (Audio) και της ψηφιακής παρτιτούρας (MIDI). 
Η εφαρμογή αναπτύχθηκε στο πλαίσιο εργασίας για το μάθημα Τεχνολογία Ήχου και Εικόνας στο Τμήμα ΗΜΜΥ του Αριστοτελείου Πανεπιστημίου Θεσσαλονίκης για το χειμερινό εξάμηνο του 2025-26

Παρέχει δυνατότητες Αυτόματης Μεταγραφής (Music Transcription) χρησιμοποιώντας μοντέλα Βαθιάς Μάθησης (Deep Learning), ενώ ταυτόχρονα αξιολογεί το επίπεδο τεχνικής δυσκολίας του παραγόμενου κομματιού.

## 🏛️ Αρχιτεκτονική Συστήματος (System Architecture)

Η εφαρμογή ακολουθεί το βιομηχανικό πρότυπο MVC (Model-View-Controller):

- **Front-End (View):** Μια διαδραστική διεπαφή χρήστη χτισμένη με HTML/CSS/JavaScript. Επικοινωνεί με τον διακομιστή μέσω ασύγχρονων κλήσεων (AJAX/Fetch API) και οπτικοποιεί τη μουσική πληροφορία (Piano Roll) χρησιμοποιώντας δυναμικά γραφικά (Canvas API).
- **Back-End (Controller):** Ένας διακομιστής βασισμένος στο Python Flask, ο οποίος αναλαμβάνει τη δρομολόγηση των αιτημάτων, τη διαχείριση των αρχείων και τη σύνθεση του ήχου (μέσω FluidSynth).
- **Core Logic (Model):** Τα αρθρώματα (modules) στον φάκελο `src/` που υλοποιούν τη βαριά μαθηματική και αλγοριθμική επεξεργασία (PyTorch, Librosa, SciPy).

## ⚙️ 1. Προαπαιτούμενα (Prerequisites)

Πριν ξεκινήσετε, είναι απαραίτητο να εγκαταστήσετε δύο εξαρτήσεις επιπέδου λειτουργικού συστήματος (OS-level dependencies). Αυτά δεν είναι πακέτα της Python, αλλά αυτόνομα προγράμματα που καλεί το σύστημά μας στο παρασκήνιο:

- **FFmpeg:** Απαραίτητο για τη βιβλιοθήκη librosa. Αποκωδικοποιεί συμπιεσμένα αρχεία ήχου (όπως `.mp3`) σε καθαρές ακολουθίες αριθμών (raw arrays) που μπορούν να διαβάσουν οι αλγόριθμοί μας.
	- **Windows:** Κατεβάστε το από το `gyan.dev` και προσθέστε το στο PATH των Windows.
	- **Ubuntu/Debian:** `sudo apt-get install ffmpeg`
	- **macOS:** `brew install ffmpeg`

- **FluidSynth:** Ένας λογισμικός συνθετητής (software synthesizer). Μετατρέπει τα σύμβολα του MIDI σε πραγματικά ηχητικά κύματα (`.wav`), ώστε να μπορείτε να τα ακούσετε μέσα από τον Web Browser.
	- **Windows/macOS/Linux:** Δείτε τον αναλυτικό οδηγό στην παρακάτω ενότητα.

## 🔊 Εγκατάσταση & Ρύθμιση FluidSynth

Η εφαρμογή χρησιμοποιεί το FluidSynth για να μετατρέπει αρχεία MIDI σε αναπαραγώγιμο ήχο (`.wav`) μέσα από τον browser.

### Windows

1. Μεταβείτε στη σελίδα [**GitHub Releases**](https://github.com/FluidSynth/fluidsynth/releases) του FluidSynth και κατεβάστε το πιο πρόσφατο πακέτο `.zip` για Windows.
2. Αποσυμπιέστε το αρχείο σε έναν σταθερό φάκελο (π.χ. `C:\tools\fluidsynth`).
3. Εντοπίστε τον φάκελο `bin` μέσα στον αποσυμπιεσμένο κατάλογο (π.χ. `C:\tools\fluidsynth\bin`).
4. Προσθέστε αυτό το path στις **System Environment Variables** → **Path**.
5. Κάντε επανεκκίνηση του terminal (ή του terminal του VS Code) ώστε να φορτωθεί το ενημερωμένο PATH.

### macOS

Εγκαταστήστε το FluidSynth με Homebrew:

```bash
brew install fluidsynth
```

### Linux (Ubuntu/Debian)

Εγκαταστήστε το FluidSynth με `apt`:

```bash
sudo apt install fluidsynth
```

### Απαίτηση Project για SoundFont

Το PlayWise απαιτεί το αρχείο SoundFont με όνομα `FluidR3_GM.sf2` να βρίσκεται στον κατάλογο `data/`:

```text
data/FluidR3_GM.sf2
```

Χωρίς αυτό το αρχείο, η μετατροπή MIDI σε ήχο θα αποτύχει.

### Επιβεβαίωση Εγκατάστασης

Μετά την εγκατάσταση (και αφού κάνετε επανεκκίνηση terminal στα Windows), επιβεβαιώστε ότι το FluidSynth είναι διαθέσιμο:

```bash
fluidsynth --version
```

Αν η εντολή εμφανίσει αριθμό έκδοσης, το FluidSynth έχει εγκατασταθεί σωστά και είναι διαθέσιμο στο PATH.

## 🚀 2. Οδηγός Εγκατάστασης (Installation Guide)

### Βήμα 1: Κλωνοποίηση του Αποθετηρίου (Clone Repository)
Ανοίξτε το τερματικό σας και εκτελέστε:

```bash
git clone https://github.com/geogkioul/PianoLearningApp.git
cd playwise
```

### Βήμα 2: Δημιουργία Εικονικού Περιβάλλοντος (Virtual Environment)
Είναι βέλτιστη πρακτική να απομονώνετε τις βιβλιοθήκες του project για να αποφύγετε διενέξεις (conflicts) με άλλα προγράμματα στον υπολογιστή σας:

```bash
# Δημιουργία περιβάλλοντος με το όνομα 'venv'
python -m venv venv

# Ενεργοποίηση (Activation)
# Για Windows:
venv\Scripts\activate
# Για Linux/macOS:
source venv/bin/activate
```

### Βήμα 3: Εγκατάσταση Πακέτων Python
Με το περιβάλλον ενεργοποιημένο, εγκαταστήστε τις απαιτήσεις του requirements.txt:

```bash
pip install -r requirements.txt
```
### Βήμα 4: Χειροκίνητη Λήψη Απαραίτητων Πόρων (Assets)
Λόγω περιορισμών μεγέθους αρχείων του GitHub (>100MB) και σεβασμού στα πνευματικά δικαιώματα τρίτων, δεν περιλαμβάνεται στο αποθετήριο η τράπεζα ήχων. Πρέπει να την προσθέσετε χειροκίνητα:
1. Πρέπει να κατεβάσετε ένα αρχείο SoundFont (προτείνεται το [FluidR3_GM.sf2](https://member.keymusician.com/Member/FluidR3_GM/))
2. Αφού το κατεβάσετε, **μεταφέρετε το αρχείο στον φάκελο data/ του project**.
3. Βεβαιωθείτε ότι το αρχείο ονομάζεται ακριβώς FluidR3_GM.sf2

Η τελική δομή των φακέλων σας πρέπει να μοιάζει κάπως έτσι:

```text
playwise/
├── data/
│   ├── uploads/          (Αυτόματος φάκελος προσωρινής αποθήκευσης)
│   └── FluidR3_GM.sf2    
├── models/
│   └── transformer.pth   
├── src/
│   ├── dl_transcriber.py
│   ├── dsp_transcriber.py
│   └── difficulty_eval.py
├── gui/
│   ├── app.py
│   └── templates/
│       └── index.html
├── requirements.txt
└── README.md
```

## 🏃 3. Εκτέλεση της Εφαρμογής (Running the App)

Επιβεβαιώστε ότι βρίσκεστε στον κεντρικό (root) φάκελο του project και το venv είναι ενεργοποιημένο. Εκτελέστε τον διακομιστή του Flask:

```bash
python app.py
```

Στο τερματικό θα δείτε ένα μήνυμα:
`Ανοίξτε τον browser σας στη διεύθυνση: http://127.0.0.1:5000`

Ανοίξτε έναν Web Browser (Chrome, Firefox, Safari) και μεταβείτε σε αυτή τη διεύθυνση. Το γραφικό περιβάλλον της εφαρμογής θα εμφανιστεί.

## 💡 4. Οδηγίες Χρήσης

### Α. Μεταγραφή Ήχου (Audio to MIDI)

Κάντε κλικ στο "Επιλογή Αρχείου" και ανεβάστε ένα καθαρό κομμάτι πιάνου μορφής .mp3 ή .wav.

Πατήστε "Μεταγραφή".
Σημείωση: Εάν χρησιμοποιείτε το Deep Learning μοντέλο μεταγραφής Transkun χωρίς Κάρτα Γραφικών (GPU), η διαδικασία μπορεί να διαρκέσει αρκετά λεπτά, ανάλογα με τη διάρκεια του κομματιού.

### Β. Ανάλυση Έτοιμου MIDI

Εάν έχετε ήδη ένα αρχείο .mid (π.χ. από το λογισμικό καταγραφής κάποιου ψηφιακού πιάνου) και θέλετε απλώς να μάθετε τη δυσκολία του ή να το οπτικοποιήσετε:

Χρησιμοποιήστε το δεξί πλαίσιο "Φόρτωση Έτοιμου MIDI".

Επιλέξτε το αρχείο σας και πατήστε "Ανάλυση MIDI". Η διαδικασία είναι σχεδόν ακαριαία, καθώς παρακάμπτεται το υπολογιστικά βαρύ βήμα της ακουστικής μεταγραφής.

### Γ. Επισκόπηση Αποτελεσμάτων

Μόλις ολοκληρωθεί η ανάλυση:

- Θα εμφανιστεί το Επίπεδο Δυσκολίας (π.χ. Beginner, Expert) συνοδευόμενο από μια βαθμολογία 1-10 (παραγόμενη από το Custom Transformer μοντέλο).
- Μπορείτε να κάνετε Αναπαραγωγή του κομματιού μέσα από τον browser (το σύστημα έχει μετατρέψει το MIDI σε ηχητικό χρησιμοποιώντας το SoundFont σας).
- Το Piano Roll θα απεικονίσει με διαδραστικό τρόπο (οπτικά μπλοκ) ποιες νότες παίζονται, βοηθώντας τον σπουδαστή να αντιληφθεί οπτικά τις χρονικές αξίες και τα διαστήματα.
- Πατήστε "Κατέβασμα MIDI" για να αποθηκεύσετε την τελική παρτιτούρα στον υπολογιστή σας και να την ανοίξετε σε οποιοδήποτε πρόγραμμα (π.χ. MuseScore, Synthesia, DAW).

## 🛠️ 5. Αντιμετώπιση Συχνών Προβλημάτων (Troubleshooting)

- **Σφάλμα FileNotFoundError: [WinError 2] The system cannot find the file specified κατά την κλήση του Transkun:**
	Βεβαιωθείτε ότι η βιβλιοθήκη transkun εγκαταστάθηκε επιτυχώς μέσω του pip και ότι οι διαδρομές των Python Scripts (π.χ. `C:\Python39\Scripts`) είναι περασμένες στις μεταβλητές περιβάλλοντος (Environment Variables) του συστήματός σας.

- **Το κομμάτι αναπαράγεται χωρίς ήχο / βγάζει σφάλμα το FluidSynth:**
	Βεβαιωθείτε ότι έχετε εγκαταστήσει το λογισμικό fluidsynth στο λειτουργικό σας σύστημα και ότι το αρχείο `FluidR3_GM.sf2` βρίσκεται μέσα στον φάκελο `data/`.

- **Πολύ αργή μεταγραφή:**
	Το PyTorch ελέγχει αυτόματα αν υπάρχει εγκατεστημένη τεχνολογία CUDA. Αν τρέχετε τον κώδικα με απλό επεξεργαστή (CPU), η επεξεργασία του νευρωνικού δικτύου διαρκεί αρκετά λεπτά. Η χρήση κάρτας γραφικών NVIDIA (GPU) μειώνει τον χρόνο μεταγραφής σημαντικά.